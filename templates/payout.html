<form method="POST" action="{{ url_for('payout') }}" class="form-wrap">
    <label for="method">Choose a payout method:</label><br>
    <select name="method" id="method" required onchange="updateWalletDisplay()">
        <option value="">--Select--</option>
        <option value="ERC20" {% if session.payout_type == 'ERC20' %}selected{% endif %}>ERC20 (Ethereum)</option>
        <option value="TRC20" {% if session.payout_type == 'TRC20' %}selected{% endif %}>TRC20 (Tron)</option>
    </select><br><br>

    <div id="erc20-wallet-info" style="display: none;">
        <label>Default ERC20 Wallet:</label><br>
        <p class="wallet-display">{{ default_erc20_wallet }}</p>
    </div>

    <div id="trc20-wallet-info" style="display: none;">
        <label>Default TRC20 Wallet:</label><br>
        <p class="wallet-display">{{ default_trc20_wallet }}</p>
    </div>

    <!-- SINGLE HIDDEN INPUT to hold selected wallet -->
    <input type="hidden" name="wallet" id="wallet">

    <button type="submit">Continue</button>
</form>

<script>
function updateWalletDisplay() {
    const method = document.getElementById('method').value;
    const walletInput = document.getElementById('wallet');
    
    document.getElementById('erc20-wallet-info').style.display = 'none';
    document.getElementById('trc20-wallet-info').style.display = 'none';

    if (method === 'ERC20') {
        document.getElementById('erc20-wallet-info').style.display = 'block';
        walletInput.value = "{{ default_erc20_wallet }}";
    } else if (method === 'TRC20') {
        document.getElementById('trc20-wallet-info').style.display = 'block';
        walletInput.value = "{{ default_trc20_wallet }}";
    } else {
        walletInput.value = '';
    }
}

document.addEventListener('DOMContentLoaded', updateWalletDisplay);
</script>
